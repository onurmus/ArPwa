function attachEventListener(e, t, s) { var n = "on" + t; if (e.addEventListener) e.addEventListener(t, s, !1); else if (e.attachEvent) e.attachEvent(n, s); else { var i = e[n]; e[n] = function () { var e = i.apply(this, arguments), t = s.apply(this, arguments); return void 0 == e ? t : void 0 == t ? e : t && e } } } function initSearchSuggest(e, t, s) { if (curSearchType = e, curSuggType = t, curLang = s, !suggestionsLoaded) { isMsie = -1 != navigator.userAgent.toLowerCase().indexOf("msie"); var n = getSearchBox(); n && (curText = n.value, n.setAttribute("autocomplete", "off"), attachEventListener(n, "keydown", onKeyDownEvent), attachEventListener(n, "keyup", onKeyUpEvent), attachEventListener(n, "keypress", onKeyPressedEvent), attachEventListener(n, "blur", onFocusLost), prevWndResizeEventHandler = window.onresize, attachEventListener(window, "resize", onWindowResized), suggestionsLoaded = !0) } } function onKeyDownEvent(e) { var t = e.keyCode; switch (t) { case 40: moveDown(), stopEvent(e); break; case 38: moveUp(), stopEvent(e) } } function onKeyUpEvent(e) { var t = e.keyCode; switch (t) { case 13: 2 == curSuggType && -1 != curSelection ? window.location.href = curSuggestionsUrnPages[curSelection] : HideSuggestionsDiv(); break; case 40: break; case 38: break; case 37: break; case 39: break; default: var s = getSearchBox().value; s != curText && (curText = s, setSearchSuggestionTimeout()) } } function onKeyPressedEvent(e) { return 27 == e.keyCode && "none" != getSearchSuggest().style.display ? (setSuggestionHideTimeout(), getSearchBox().value = curText, !1) : void 0 } function onFocusLost(e) { setSuggestionHideTimeout() } function onWindowResized(e) { getSearchSuggest().style.width = getSearchBox().offsetWidth, prevWndResizeEventHandler && prevWndResizeEventHandler(e) } function displaySuggestions(e, t, s, n, r, u, g) { try { curSize = Math.min(maxSuggestions, e.length) } catch (o) { curSize = 0 } var a = getSearchSuggest(); a.innerHTML = "", curSize > 0 ? a.style.display = "" : HideSuggestionsDiv(); var c = ""; for (i = 0; i < curSize; ++i)1 == curSuggType ? (c += '<div id="sugdiv' + i + '" onmouseover="javascript:suggestOver(this);" ', c += 'onmouseout="javascript:suggestOut(this);" ', c += 'onclick="javascript:setSearchByIndex(' + i + ');" ', c += 'class="suggest_link">' + getFormatedSuggestionLine(e[i]) + "</div>") : (c += '<div id="sugdiv' + i + '" onmouseover="javascript:suggestOver(this);" ', c += 'onmouseout="javascript:suggestOut(this);" ', c += "onclick=\"window.location.href='" + s[i] + "';\" ", c += 'class="suggest_link"><table border="0" cellpadding="0" cellspacing="0"><tr><th><img border="0" src="' + t[i] + '"/></th><td><span>' + getFormatedSuggestionLine(e[i]) + '</span></td><td><img border="0" class="suggest_urnsmallimg emos_invisible" src="' + n[i] + '"/></td><td><span class="suggest_urnprice emos_invisible">' + r[i] + '</span></td><td><span class="suggest_urnurunkod emos_invisible">' + u[i] + '</span></td><td><span class="suggest_urnnormalprice emos_invisible">' + g[i] + "</span></td></tr></table></div>"); a.innerHTML = htmlFormat.replace("$$urunler$$", c).replace("$$kategoriler$$", strKat).replace("$$strTumunuGoster$$", strAramaTumunuGoster).replace("$$kelimeOnerme$$", strKelimeOnerme).replace("$$aramaBaslik$$", getSuggestionsDivTitle()) } function suggestOver(e) { e.style.cursor = "default", unhighlightCurrentSuggestion(), divId = e.id, curSelection = divId.substr(6), highlightCurrentSuggestion(!1) } function suggestOut(e) { unhighlightSuggestion(e) } function setSearch(e) { curTextSel = e, getSearchBox().value = e } function setSearchByIndex(e) { setSearch(curSuggestions[e]), getSearchSuggest().innerHTML = "" } function highlightSuggestion(e) { e.className = "suggest_link_over" } function unhighlightSuggestion(e) { e.className = "suggest_link" } function highlightCurrentSuggestion(e) { e && 1 == curSuggType && setSearch(-1 == curSelection ? curText : curSuggestions[curSelection]); var t = document.getElementById("sugdiv" + curSelection); highlightSuggestion(t) } function unhighlightCurrentSuggestion() { var e = null; try { e = document.getElementById("sugdiv" + curSelection) } catch (t) { } e && unhighlightSuggestion(e) } function moveDown() { if (!(0 >= curSize)) try { unhighlightCurrentSuggestion(), curSelection >= curSize - 1 ? curSelection = -1 : ++curSelection, highlightCurrentSuggestion(!0) } catch (e) { } } function moveUp() { if (!(0 >= curSize)) try { unhighlightCurrentSuggestion(), 0 > curSelection ? curSelection = curSize - 1 : --curSelection, highlightCurrentSuggestion(!0) } catch (e) { } } function stopEvent(e) { isMsie ? e.cancelBubble = !0 : e.preventDefault() } function getFormatedSuggestionLine(e) { var t = curText.toLowerCase(), s = e.toLowerCase(), n = curText.length, i = s.indexOf(t); return -1 == i ? e : e.substr(0, i) + "<b>" + e.substr(i, n) + "</b>" + e.substr(i + n) } function getSearchBox() { return document.getElementById("txtARM_KEYWORD") } function getSearchSuggest() { return suggestDiv || (suggestDiv = createSuggestionDiv(getSearchBox())), suggestDiv } function findPos(e) { var t = curtop = 0; if (e.offsetParent) do t += e.offsetLeft, curtop += e.offsetTop; while (e = e.offsetParent); return [t, curtop] } function createSuggestionDiv(e) { var t = document.createElement("div"); t.className = "searchSuggestDiv", t.style.position = "absolute"; var s = findPos(e); return t.style.left = void 0 === s[0] ? 0 : s[0], isMsie && (t.style.top = (void 0 === s[1] ? 0 : s[1]) + e.offsetHeight), t.style.width = e.offsetWidth, t.style.zIndex = "130", t.style.display = "none", t.id = "search_suggest", e.parentNode.appendChild(t), t } function setSuggestionHideTimeout() { hideDelayTimerId = setTimeout(function () { return function () { hideDelayTimerId = null, HideSuggestionsDiv() } }(), 300) } function setSearchSuggestionTimeout() { searchSuggestionTimerId && (clearTimeout(searchSuggestionTimerId), searchSuggestionTimerId = null), searchSuggestionTimerId = setTimeout(function () { return function () { searchJSONSuggest(), searchSuggestionTimerId = null, curSelection = -1 } }(), 600) } function getSuggestionsDivTitle() { return document.getElementById(aramaClientID + "_lbfARAMA_ONERI").innerHTML } function HideSuggestionsDiv() { curSize = 0, getSearchSuggest().innerHTML = "", getSearchSuggest().style.display = "none", curSelection = -1 } function searchJSONSuggest() { var searchInCtrl = document.getElementById(aramaClientID + "_drpKAT_AD"); curText = getSearchBox().value; var textLength = getSearchBox().getAttribute("data-max") || 3, srtString = getSearchBox().getAttribute("srt") || ""; if (curText.length < textLength) return void HideSuggestionsDiv(); var str = encodeURIComponent(curText); null != searchInCtrl && "" != searchInCtrl.value ? $.get("/userControls/kutu/ascArama_ajx.aspx", "searchType=" + curSearchType + "&suggType=" + curSuggType + "&srt=" + srtString + "&text=" + str + "&katkod=" + searchInCtrl.value + "&lang=" + curLang, function (data) { eval(data), "undefined" != typeof stage && stage.dispatchEvent("CustomEvent", "aramaSonucDoldur") }) : $.get("/userControls/kutu/ascArama_ajx.aspx", "searchType=" + curSearchType + "&suggType=" + curSuggType + "&srt=" + srtString + "&text=" + str + "&lang=" + curLang, function (data) { eval(data), "undefined" != typeof stage && stage.dispatchEvent("CustomEvent", "aramaSonucDoldur") }) } function updateCompletion() { suggestRequest && (suggestRequest = null), curSuggestions = completion[1], curSuggestionsImages = completion[2], curSuggestionsUrnPages = completion[3], curSuggestionsUrnSmallImages = completion[4], curSuggestionsUrnPrices = completion[5], curSuggestionsUrnUrunKod = completion[6], curSuggestionsUrnNormalPrice = completion[7], displaySuggestions(curSuggestions, curSuggestionsImages, curSuggestionsUrnPages, curSuggestionsUrnSmallImages, curSuggestionsUrnPrices, curSuggestionsUrnUrunKod, curSuggestionsUrnNormalPrice) } var curSelection = -1, curSuggestions = [], curSuggestionsImages = [], curSuggestionsUrnPages = [], curSuggestionsUrnSmallImages = [], curSuggestionsUrnPrices = [], curSuggestionsUrnUrunKod = [], curSuggestionsUrnNormalPrice = [], curSize = 0, curText = "", curTextSel = "", hideDelayTimerId = null, searchSuggestionTimerId = null, maxSuggestions = 10, prevWndResizeEventHandler = null, prevWndOnLoadEventHandler = null, isMsie = !1, suggestRequest = null, suggestionsLoaded = !1, suggestDiv = null, curSearchType = 1, curSuggType = 1, curLang = "tr-TR", htmlFormat = "<div class='searchSuggestDivHolder'><div class='prd'><h3>Ürünler <small>$$aramaBaslik$$</small></h3><div class='sHolder'>$$urunler$$</div></div><div class='cat'><h3>Kategoriler</h3><div class='sHolder'>$$kategoriler$$</div></div><div class='dvTumunuGoster emos_invisible'><a href='javascript:void(0);' onclick='return generateSearchLink();' id='ascAramaBtnTumunuGoster' class='btnDefault btnArama'>$$strTumunuGoster$$</a></div><div class='wordSearch'><div class='sHolder'>$$kelimeOnerme$$</div></div><div class='floatFixer'></div></div>";